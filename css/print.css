/* ================================
   印刷最適化（A4縦・1カラム・全章出力）
   ================================ */
   @page {
    size: A4 portrait;
    margin: 16mm 14mm; /* 上下 / 左右 */
  }
  
  /* できる限り画面の色を維持 */
  * {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
  
  @media print {
  
    /* 背景/外枠の除去＆1カラム化 */
    html, body { background: #fff !important; }
    .manual-wrapper { display: block !important; background: #fff !important; min-height: auto !important; }
  
    /* 画面専用UIは非表示（サイドバー・タブなど） */
    .manual-sidebar,
    .hamburger-menu,
    .menu-overlay,
    .sub-items-panel,
    .result-panel,
    .content-tabs,
    nav.breadcrumb,
    .version-info {
      display: none !important;
    }
  
    /* 中央カラムを全幅に */
    .manual-content {
      display: block !important;
      padding: 0 !important;
      margin: 0 !important;
      max-width: none !important;
    }
    .content-panel {
      width: 100% !important;
      max-width: 100% !important;
      padding: 0 !important;
      margin: 0 !important;
    }
  
    /* ====== 全章出力（タブの非表示状態を無視） ====== */
    /* JSで付いている .is-hidden を無効化して全セクションを出す */
    .step-section.is-hidden { display: block !important; }
    /* 念のため hidden 属性・visibility の影響も無効化（中央パネル配下だけ） */
    .content-panel [hidden] { display: block !important; visibility: visible !important; }
  
    /* セクションの紙面向けレイアウト */
    .step-section {
      background: #fff !important;
      color: #000 !important;
      border: 0 !important;
      box-shadow: none !important;
      border-radius: 0 !important;
      padding: 0 0 12mm 0 !important; /* 下だけ余白 */
      margin: 0 !important;
      break-inside: avoid-page;    /* 途中分割を抑制 */
      page-break-inside: avoid;    /* 旧プロパティ互換 */
    }
  
    /* 次の章は新しいページから（章頭出し） */
    .step-section + .step-section {
      break-before: page;         /* 章区切りで改ページ */
      page-break-before: always;  /* 旧プロパティ互換 */
    }
  
    /* 見出しと直後の要素は分割しない */
    .step-header,
    .step-header h2,
    .step-objective,
    .step-content h3,
    .procedure-item,
    .notes {
      break-inside: avoid;
      page-break-inside: avoid;
    }
  
    /* 見出しサイズ微調整（紙面） */
    .step-header h2 {
      font-size: 20pt !important;
      margin: 0 0 6mm !important;
      color: #111 !important;
    }
  
    /* 番号は印刷でも非表示 */
    .step-number { display: none !important; }
  
  /* カード風パーツの装飾をフラット化 */
  .step-objective,
  .step-content h3 {
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 0 5mm !important;
  }
  .step-content h3 {
    font-size: 13pt !important;
    border-bottom: 1px solid #ddd !important;
    padding-bottom: 2mm !important;
  }

  /* ====== 印刷時：h4の横にh3を右寄せで表示 ====== */
  .procedure-item h4 {
    display: flex !important;
    justify-content: space-between !important;
    align-items: flex-end !important;  /* 下揃えに変更 */
    width: 100% !important;
  }
  
  /* h3を右側に配置（JavaScriptで動的に追加） */
  .procedure-item h4 .print-h3 {
    margin-left: auto !important;
    font-size: 9pt !important;  /* 11pt → 9ptに縮小 */
    color: #666 !important;
    font-weight: normal !important;
    border: none !important;
    padding: 0 !important;
    padding-left: 20px !important;
    flex-shrink: 0 !important;
  }
  
    /* 手順レイアウトをPC同等の2カラムに（画像50% + テキスト50%） */
    .step-with-image { 
      display: grid !important; 
      grid-template-columns: 1fr 1fr !important; 
      gap: 6mm !important; 
      align-items: flex-start !important; 
      break-inside: avoid !important; 
      page-break-inside: avoid !important; 
    }
  
    /* 画像は最大幅で表示、装飾は除去 */
    .procedure-image, .step-image { border: 0 !important; box-shadow: none !important; }
    .procedure-image img, .step-image img { width: 100% !important; max-width: 100% !important; height: auto !important; }
    .procedure-image { margin: 0 0 4mm !important; break-inside: avoid; page-break-inside: avoid; }
    img { break-inside: avoid; page-break-inside: avoid; }
    /* ワンポイントアドバイスは常に全幅 */
    .step-advice { grid-column: 1 / -1 !important; }
  
    /* テキスト・リストの読みやすさ */
    .procedure-text { width: 100% !important; }
    .procedure-text ol,
    .procedure-text ul {
      margin: 0 0 4mm 6mm !important;
    }
    .procedure-text li {
      margin: 1.2mm 0 !important;
      line-height: 1.6 !important;
    }
  
    /* 注意枠は紙面用に簡素化 */
    .notes {
      background: transparent !important;
      border-left: 3px solid #bbb !important;
      padding: 3mm 4mm !important;
      margin-top: 4mm !important;
      color: #333 !important;
    }
  
    /* 余計な固定配置・アニメの抑止（sticky等の不具合回避） */
    * { animation: none !important; transition: none !important; }

    /* ====== 印刷用 目次とフッター ====== */
    /* 1ページ目: 既存のイラスト入り表紙（#top セクションを表紙扱い） */
    .print-cover { display:block !important; page-break-after: always !important; }
    /* 2ページ目: 自動生成した目次（#print-toc を #topのすぐ後にJSで挿入） */
    #print-toc { display:block !important; page-break-after: always !important; max-width: 120mm !important; margin: 0 auto 0 auto !important; }
    #print-toc h2 { font-size: 14pt !important; margin: 0 0 6mm !important; color:#111 !important; border-bottom: 1px solid #bbb !important; padding-bottom: 3mm !important; }
    #print-toc ol { list-style: none !important; counter-reset: toc; padding: 0 !important; margin: 0 !important; }
    #print-toc li { counter-increment: toc; font-size: 11pt !important; margin: 2mm 0 !important; color:#333 !important; }
    #print-toc li::before { content: counters(toc, '.') '. '; color:#777 !important; }

    /* 今回はページ番号を非表示に戻す */
    .print-page-reset, .print-footer { display:none !important; }
    .print-footer::after { content: 'p.' counter(page, decimal-leading-zero); font-size: 9pt !important; color:#666 !important; }
  
    /* 寄せ/孤行の軽減（対応ブラウザ向け） */
    p, li { orphans: 3; widows: 3; }
  }
  