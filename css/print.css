/* ================================
   印刷最適化（A4縦・1カラム・全章出力）
   ================================ */
   @page {
    size: A4 portrait;
    margin: 16mm 14mm; /* 上下 / 左右 */
  }
  
  /* できる限り画面の色を維持 */
  * {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
  
  @media print {
  
    /* 背景/外枠の除去＆1カラム化 */
    html, body { background: #fff !important; }
    .manual-wrapper { display: block !important; background: #fff !important; min-height: auto !important; }
  
    /* 画面専用UIは非表示（サイドバー・タブなど） */
    .manual-sidebar,
    .hamburger-menu,
    .menu-overlay,
    .sub-items-panel,
    .result-panel,
    .content-tabs,
    nav.breadcrumb,
    .version-info {
      display: none !important;
    }
  
    /* 中央カラムを全幅に */
    .manual-content {
      display: block !important;
      padding: 0 !important;
      margin: 0 !important;
      max-width: none !important;
    }
    .content-panel {
      width: 100% !important;
      max-width: 100% !important;
      padding: 0 !important;
      margin: 0 !important;
    }
  
    /* ====== 全章出力（タブの非表示状態を無視） ====== */
    /* JSで付いている .is-hidden を無効化して全セクションを出す */
    .step-section.is-hidden { display: block !important; }
    /* 念のため hidden 属性・visibility の影響も無効化（中央パネル配下だけ） */
    .content-panel [hidden] { display: block !important; visibility: visible !important; }
  
    /* セクションの紙面向けレイアウト */
    .step-section {
      background: #fff !important;
      color: #000 !important;
      border: 0 !important;
      box-shadow: none !important;
      border-radius: 0 !important;
      padding: 0 0 12mm 0 !important; /* 下だけ余白 */
      margin: 0 !important;
      break-inside: avoid-page;    /* 途中分割を抑制 */
      page-break-inside: avoid;    /* 旧プロパティ互換 */
    }
  
    /* 次の章は新しいページから（章頭出し） */
    .step-section + .step-section {
      break-before: page;         /* 章区切りで改ページ */
      page-break-before: always;  /* 旧プロパティ互換 */
    }
  
    /* 見出しと直後の要素は分割しない */
    .step-header,
    .step-header h2,
    .step-objective,
    .step-content h3,
    .procedure-item,
    .notes {
      break-inside: avoid;
      page-break-inside: avoid;
    }
  
    /* 見出しサイズ微調整（紙面） */
    .step-header h2 {
      font-size: 20pt !important;
      margin: 0 0 6mm !important;
      color: #111 !important;
    }
  
    /* 番号は印刷でも非表示 */
    .step-number { display: none !important; }
  
  /* カード風パーツの装飾をフラット化 */
  .step-objective,
  .step-content h3 {
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 0 5mm !important;
  }
  .step-content h3 {
    font-size: 13pt !important;
    border-bottom: 1px solid #ddd !important;
    padding-bottom: 2mm !important;
  }

  /* ====== 印刷時：h4の横にh3を右寄せで表示 ====== */
  .procedure-item h4 {
    display: flex !important;
    justify-content: space-between !important;
    align-items: flex-end !important;  /* 下揃えに変更 */
    width: 100% !important;
  }
  
  /* h3を右側に配置（JavaScriptで動的に追加） */
  .procedure-item h4 .print-h3 {
    margin-left: auto !important;
    font-size: 9pt !important;  /* 11pt → 9ptに縮小 */
    color: #666 !important;
    font-weight: normal !important;
    border: none !important;
    padding: 0 !important;
    padding-left: 20px !important;
    flex-shrink: 0 !important;
  }
  
  /* 手順レイアウトをPC同等の2カラムに（テキスト左50% + 画像右50%） */
  .step-with-image { 
    display: grid !important; 
    grid-template-columns: 1fr 1fr !important; 
    gap: 6mm !important; 
    align-items: flex-start !important; 
    break-inside: avoid !important; 
    page-break-inside: avoid !important; 
    grid-auto-flow: dense !important; /* PC表示と同じ */
  }

  /* テキストを左側（1列目）に配置 */
  .step-text {
    grid-column: 1 !important;
    grid-row: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 3mm !important;
  }

  /* 画像を右側（2列目）に配置 */
  .step-image { 
    grid-column: 2 !important;
    grid-row: 1 !important;
    border: 0 !important; 
    box-shadow: none !important; 
  }
  
  /* 画像は最大幅で表示、装飾は除去 */
  .procedure-image { border: 0 !important; box-shadow: none !important; }
  .procedure-image img, .step-image img { width: 100% !important; max-width: 100% !important; height: auto !important; }
  .procedure-image { margin: 0 0 4mm !important; break-inside: avoid; page-break-inside: avoid; }
  img { break-inside: avoid; page-break-inside: avoid; }
  
  /* ワンポイントアドバイスは常に全幅（グリッドの下部） */
  .step-advice { 
    grid-column: 1 / -1 !important; 
    grid-row: 2 !important;
    margin-top: 3mm !important;
  }
  
  /* テキスト・リストの読みやすさ */
  .procedure-text { width: 100% !important; }
  .procedure-text ol,
  .procedure-text ul,
  .step-text ul {
    margin: 0 0 4mm 6mm !important;
  }
  .step-text ol {
    margin: 0 0 4mm 0 !important;
    padding-left: 0 !important;
    list-style: none !important;
  }
  .procedure-text li,
  .step-text ul li {
    margin: 1.2mm 0 !important;
    line-height: 1.6 !important;
  }
  .step-text ol {
    padding-left: 8mm !important;
    list-style-type: decimal !important;
  }
  .step-text ol li {
    margin: 2mm 0 !important;
    padding-left: 3mm !important;
    line-height: 1.6 !important;
  }
  /* 印刷時の番号スタイル */
  .step-text ol li::marker {
    color: #0066cc !important;
    font-weight: bold !important;
  }
  
  /* ボタンラベルの印刷スタイル */
  .button-label {
    display: inline-block !important;
    padding: 0.8mm 2mm !important;
    background: #e7f2ff !important;
    border: 0.5pt solid #b8d4f0 !important;
    border-radius: 1mm !important;
    font-weight: 600 !important;
    color: #0969da !important;
    font-size: 0.9em !important;
    margin: 0 1mm !important;
    white-space: nowrap !important;
    vertical-align: baseline !important;
    line-height: 1.2 !important;
  }

  /* note-cardとstep-adviceの印刷用スタイル */
  .note-card {
    background: #fffbf0 !important;
    border: 1px solid #f0d080 !important;
    border-radius: 4px !important;
    padding: 3mm 4mm !important;
    margin: 3mm 0 !important;
    break-inside: avoid !important;
    page-break-inside: avoid !important;
    /* 印刷時は全幅で表示 */
    grid-column: 1 / -1 !important;
    width: 100% !important;
  }
  
  .note-card h5 {
    font-size: 10pt !important;
    font-weight: bold !important;
    margin: 0 0 2mm !important;
    color: #d4a000 !important;
  }
  
  .step-advice {
    background: #f0fff4 !important;
    border: 1px solid #90d4a0 !important;
    border-radius: 4px !important;
    padding: 3mm 4mm !important;
    margin: 3mm 0 !important;
    break-inside: avoid !important;
    page-break-inside: avoid !important;
  }
  
  .step-advice h5 {
    font-size: 10pt !important;
    font-weight: bold !important;
    margin: 0 0 2mm !important;
    color: #40a050 !important;
  }

  /* 注意枠は紙面用に簡素化（旧スタイル） */
  .notes {
    background: transparent !important;
    border-left: 3px solid #bbb !important;
    padding: 3mm 4mm !important;
    margin-top: 4mm !important;
    color: #333 !important;
  }
  
  /* サブセクション用のスタイル */
  .step-with-subsection {
    display: flex !important;
    flex-direction: column !important;
    gap: 4mm !important;
    margin-bottom: 6mm !important;
  }
  
  .step-subsection-title {
    font-size: 11pt !important;
    font-weight: bold !important;
    color: #0066cc !important;
    margin: 0 0 3mm !important;
    padding: 0 !important;
  }
  
  /* サブセクション間のディバイダー */
  .procedure-steps .step-with-subsection:not(:last-child) {
    padding-bottom: 6mm !important;
    border-bottom: 1px solid #ddd !important;
  }
  
  /* 余計な固定配置・アニメの抑止（sticky等の不具合回避） */
  * { animation: none !important; transition: none !important; }

    /* ====== 印刷用 目次とフッター ====== */
    /* 1ページ目: 既存のイラスト入り表紙（#top セクションを表紙扱い） */
    .print-cover { 
      display:block !important; 
      page-break-after: always !important; 
    }
    
    /* 印刷表紙のスタイル */
    .print-cover.only-print {
      padding: 30mm 25mm !important;
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      justify-content: center !important;
      min-height: 100vh !important;
      text-align: center !important;
    }
    
    .print-cover.only-print img {
      max-width: 80mm !important;
      height: auto !important;
      margin-bottom: 20mm !important;
    }
    
    .print-cover.only-print h1 {
      font-size: 28pt !important;
      color: #0066cc !important;
      font-weight: bold !important;
      line-height: 1.4 !important;
      margin: 0 !important;
    }
    
    /* 2ページ目: 印刷用目次 */
    .print-toc-page { 
      display:block !important; 
      page-break-after: always !important; 
      padding: 20mm 25mm !important;
    }
    .print-toc-title { 
      font-size: 20pt !important; 
      margin: 0 0 15mm !important; 
      color: #0066cc !important; 
      border-bottom: 2pt solid #0066cc !important; 
      padding-bottom: 4mm !important; 
    }
    .print-toc-content { font-size: 11pt !important; }
    .print-toc-section { margin-bottom: 6mm !important; }
    .print-toc-section h3 { 
      font-size: 12pt !important; 
      font-weight: bold !important; 
      color: #0066cc !important; 
      margin: 0 0 2mm 0 !important; 
    }
    .print-toc-sublist { 
      list-style: none !important; 
      padding-left: 8mm !important; 
      margin: 0 !important; 
    }
    .print-toc-sublist li { 
      margin: 1.5mm 0 !important; 
      font-size: 10pt !important; 
      color: #333 !important; 
    }
    /* Section1のサブリストは番号付き */
    .print-toc-section:first-of-type .print-toc-sublist { counter-reset: toc-item !important; }
    .print-toc-section:first-of-type .print-toc-sublist li { counter-increment: toc-item !important; }
    .print-toc-section:first-of-type .print-toc-sublist li::before { content: counter(toc-item) ". " !important; margin-right: 2mm !important; }

    /* 今回はページ番号を非表示に戻す */
    .print-page-reset, .print-footer { display:none !important; }
    .print-footer::after { content: 'p.' counter(page, decimal-leading-zero); font-size: 9pt !important; color:#666 !important; }
  
    /* 寄せ/孤行の軽減（対応ブラウザ向け） */
    p, li { orphans: 3; widows: 3; }
  }
  